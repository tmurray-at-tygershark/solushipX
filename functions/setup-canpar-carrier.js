const admin = require("firebase-admin"); if (!admin.apps.length) { admin.initializeApp(); } const db = admin.firestore(); async function setupCanparCarrier() { try { console.log("Setting up CANPAR carrier..."); const carriersRef = db.collection("carriers"); const snapshot = await carriersRef.where("carrierID", "==", "CANPAR").get(); const carrierData = { apiCredentials: { username: "test_username", password: "test_password", accountNumber: "test_account", hostURL: "https://sandbox.canpar.com", endpoints: { rate: "canshipws/services/CanparRatingService/rateShipment", cancel: "canshipws/services/CanparAddonsService/voidShipment", labels: "canshipws/services/CanparAddonsService/getLabels", status: "canshipws/services/CanparAddonsService/getShipment", tracking: "canshipws/services/CanparAddonsService/trackShipment" } }, enabled: true, status: "active", updatedAt: admin.firestore.FieldValue.serverTimestamp() }; if (!snapshot.empty) { console.log("CANPAR carrier already exists, updating..."); const doc = snapshot.docs[0]; await doc.ref.update(carrierData); console.log("✅ CANPAR carrier updated"); } else { console.log("Creating new CANPAR carrier..."); await carriersRef.add({ name: "Canpar Express", carrierID: "CANPAR", type: "courier", enabled: true, status: "active", logoFileName: "canpar.png", ...carrierData, createdAt: admin.firestore.FieldValue.serverTimestamp() }); console.log("✅ CANPAR carrier created"); } } catch (error) { console.error("Error:", error); } finally { process.exit(0); } } setupCanparCarrier();
